# 室內設計公司應用系統 - 需求規格文件 (最終確認版)

**版本：** 2.0  
**日期：** 2026-02-04  
**狀態：** 待確認 (整合 AI 功能、動態審核與細項估價)

---

## 1. 系統概述
本系統為專為室內設計公司打造的智慧化營運平台，核心在於利用 **AI (Nano Banana)** 賦能設計流程，並透過**彈性審核機制**與**細項化財務管理**，實現從客戶開發、專案規劃、精確估價到施工監管的全數位化管理。

---

## 2. 核心角色定義 (Role & Permission)

| 角色 | 職責 | 權限範圍 |
| :--- | :--- | :--- |
| **系統管理員** | 系統維護、權限配置 | 帳號控制、系統日誌、流程模板定義 |
| **老闆 (Boss)** | 公司決策、全域財務監管 | 全域專案/財務查看、最高級別流程審核 |
| **主管 (Manager)** | 部門管理、審核與調度 | 部屬專案監控、二級流程審核、工班衝突解決 |
| **員工 (Staff)** | 執行設計與案場管理 | **限指派專案**的操作、圖檔上傳、估價草稿製作 |

---

## 3. 功能模組規格

### 3.1 認證與安全性
*   **Google OAuth 2.0**：支援公司網域 (@yourcompany.com) 一鍵登入。
*   **多因子驗證**：間接利用 Google 帳戶安全性保護專案資料。

### 3.2 客戶與廠商管理 (CRM & SCM)
*   **客戶管理**：追蹤洽談記錄、風格偏好、歷年專案關聯。
*   **廠商管理**：建立材料供應商資料庫、付款帳戶資訊、產品型錄與品質評分。

### 3.3 智慧圖檔與 AI 輔助設計
*   **功能整合**：串接 **Nano Banana** AI 模型。
*   **AI 繪圖功能**：
    *   **草稿轉渲染**：將平面或白框圖一鍵生成寫實效果圖。
    *   **局部修圖 (In-painting)**：透過對話指令修改材質或物件。
    *   **風格遷移**：快速變換空間設計風格。
*   **版本控制**：所有圖檔（平面、施工、3D、AI 生成）皆具備版本追蹤功能。

### 3.4 精確估價系統 (核心功能)
*   **細項化管理**：支援「空間/工程大類」分組（如：客廳、基礎工程）。
*   **單價資料庫 (Item Library)**：維護標準化材料、工項及參考單價，快速引用。
*   **AI 視覺估價 (AI Vision Link)**：
    *   **圖片識別**：從上傳的平面圖自動辨識空間範圍、長度及物件數量。
    *   **自動產出初稿**：AI 根據識圖結果自動填充初步估價單細項。
    *   **對話式修正**：使用自然語言調整估價內容（如：「把隔間牆改為矽酸鈣板」）。

### 3.5 彈性流程審核
*   **自定義審核流**：管理者可根據公司需求設定「1階主管審核」或「2階主管+老闆審核」。
*   **多維度指定**：可依「角色」或「特定人員」設定審核關卡。
*   **稽核紀錄**：完整保留審核意見與時間戳記。

### 3.6 專案與工班管理 (ERP)
*   **階段流轉**：洽談 → 設計 → 施工 → 完工 → 結案。
*   **工班調度**：視覺化行事曆排程，自動檢查工班衝突。
*   **財務流水**：記錄專案進度收支、發票號碼、專案毛利分析。

---

## 4. 資料庫架構概述 (Prisma Based)
*   **User**: 整合本地與 Google ID。
*   **Project / Client**: 業務核心。
*   **Quotation / Section / Item**: 支援分組的細項估價。
*   **ApprovalWorkflow / Step / Record**: 實現彈性審核邏輯。
*   **Drawing / AIGenerationLog**: 儲存圖檔與 AI 參數歷程。
*   **Vendor / WorkCrew / Schedule**: 供應鏈與施工排程。

---

## 5. UI/UX 設計準則 (L'Atelier Aesthetic)
*   **視覺風格**：現代簡約、深色/白金色調、高品質襯線字 (Serif)。
*   **互動設計**：側邊垂直導航、毛玻璃效果 (Glassmorphism)、動態載入動畫。
*   **行動優先**：支援工地現場即時查看圖檔與進度報表。

---

## 6. 後續開發優先順序 (MVP Phase)
1.  **Phase 1**：Google Auth 登入、客戶/專案基本 CRUD、資料庫初始化。
2.  **Phase 2**：**AI 視覺估價原型**、細項估價編輯器。
3.  **Phase 3**：彈性審核流實作、工班排程行事曆。
4.  **Phase 4**：財務報表、PDF 估價單輸出。

---

*請確認上述規格是否完整，若無誤我們將正式進入 Phase 1 的邏輯開發。*
